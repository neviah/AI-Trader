"use strict";(()=>{var e={};e.id=1434,e.ids=[1434],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3176:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>u,originalPathname:()=>A,requestAsyncStorage:()=>c,routeModule:()=>n,serverHooks:()=>l,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>d});var r={};a.r(r),a.d(r,{GET:()=>GET,POST:()=>POST});var s=a(884),o=a(6132),i=a(5798);let AlpacaAPI=class AlpacaAPI{constructor(e,t,a=!0){this.apiKey=e,this.secretKey=t,this.paperTrading=a,this.baseUrl=a?"https://paper-api.alpaca.markets":"https://api.alpaca.markets"}async getAccount(){try{let e=await fetch(`${this.baseUrl}/v2/account`,{headers:{"APCA-API-KEY-ID":this.apiKey,"APCA-API-SECRET-KEY":this.secretKey,"Content-Type":"application/json"}});if(!e.ok)throw Error(`Alpaca API error: ${e.status}`);return await e.json()}catch(e){throw console.error("Failed to get account info:",e),e}}async submitOrder(e,t,a){try{let r=await fetch(`${this.baseUrl}/v2/orders`,{method:"POST",headers:{"APCA-API-KEY-ID":this.apiKey,"APCA-API-SECRET-KEY":this.secretKey,"Content-Type":"application/json"},body:JSON.stringify({symbol:e.toUpperCase(),qty:t,side:a,type:"market",time_in_force:"gtc"})});if(!r.ok)throw Error(`Alpaca API error: ${r.status}`);return await r.json()}catch(e){throw console.error("Failed to submit order:",e),e}}};async function GET(){try{let e=process.env.ALPACA_API_KEY,t=process.env.ALPACA_SECRET_KEY,a="true"===process.env.ALPACA_PAPER_TRADING;if(!e||!t)return i.Z.json({error:"Alpaca API credentials not configured"},{status:500});let r=new AlpacaAPI(e,t,a),s=await r.getAccount();return i.Z.json({success:!0,account:{account_id:s.account_number||s.id,buying_power:parseFloat(s.buying_power||"0"),cash:parseFloat(s.cash||"0"),portfolio_value:parseFloat(s.portfolio_value||"0"),equity:parseFloat(s.equity||"0"),day_trade_count:parseInt(s.daytrade_buying_power||"0"),status:s.status||"UNKNOWN",paper_trading:a}})}catch(e){return console.error("Alpaca API error:",e),i.Z.json({error:"Failed to fetch account info",details:e.message},{status:500})}}async function POST(e){try{let{action:t,symbol:a,quantity:r}=await e.json(),s=process.env.ALPACA_API_KEY,o=process.env.ALPACA_SECRET_KEY,n="true"===process.env.ALPACA_PAPER_TRADING;if(!s||!o)return i.Z.json({error:"Alpaca API credentials not configured"},{status:500});let c=new AlpacaAPI(s,o,n),p=await c.submitOrder(a,parseFloat(r),t);return i.Z.json({success:!0,order:{order_id:p.id,symbol:p.symbol,quantity:parseFloat(p.qty),side:p.side,order_type:p.type,status:p.status,submitted_at:p.submitted_at,filled_qty:parseFloat(p.filled_qty||"0"),filled_avg_price:parseFloat(p.filled_avg_price||"0")}})}catch(e){return console.error("Alpaca trade error:",e),i.Z.json({error:"Failed to execute trade",details:e.message},{status:500})}}let n=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/trading/alpaca/route",pathname:"/api/trading/alpaca",filename:"route",bundlePath:"app/api/trading/alpaca/route"},resolvedPagePath:"/workspaces/AI-Trader/frontend/app/api/trading/alpaca/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:c,staticGenerationAsyncStorage:p,serverHooks:l,headerHooks:u,staticGenerationBailout:d}=n,A="/api/trading/alpaca/route"}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[1997],()=>__webpack_exec__(3176));module.exports=a})();